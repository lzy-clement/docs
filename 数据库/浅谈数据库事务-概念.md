# 概览
最近在做数据库相关的中间件，为了更深入的了解数据库相关知识，整理了一下一些资料，尝试讲述一下关于数据库的相关知识。由于数据库的知识博大精深，因此分了几个章节来讲述。

首先我们先来了解一个概念，数据库跟我们文件系统最大的区别，就是其事务特性。在文件系统中，我们没办法保证在操作两个或多个文件时，能同时成功（或者同时失败）。这个道理很容易理解，当我们操作完一个文件时，突然发生宕机或各种情况，导致后续操作终止了，当该文件系统重启或恢复时，已经操作的文件也无法回滚了，未操作的文件，有可能程序也不知道该从哪个时间点开始切入继续执行了。

因此数据库事务的意义就诞生了。数据库事务在设计时，就保证了ACID的特性。

# 事务的ACID特性
## 原子性（Atomicity）
保证在一个事务中的操作是原子操作。
> e.g 例如我们银行转账，A账户往B账户转200元。在A账户扣除200元的同时，B账户也需要增加200元，这两个操作必须同时成功或同时失败。否则只有一个成功，那么要不就A少了200元，要不B多了200元。凭空就产生了200元漏洞，这明显不可接受。

## 一致性（Consistency）
保证在一个事务执行前后，数据保证一致。
> e.g 例如一个完整性约束，a+b=10,一个事务改变了a，b也随之改变。又例如，一个有唯一约束的表，事务前后都不违背其唯一约束的特性。

## 隔离性（Isolation）
也称为并发控制。使用悲观或乐观锁机制实现。确保并发执行的事务能按顺序一个一个的执行。一个未完成的事务并不会影响另一个事务。

## 持久性（Durability）
一个成功提交（commit）的事务，将永久改变其系统状态。即使由于系统崩溃或断电，事务中的数据改变未写入磁盘，那么系统恢复后也会将此数据恢复。

这里可能有人会好奇，既然我都提交（commit）了，那么我的数据理所当然的保存在存储系统中了，这还属于一个特性？<br>
实际上，在Mysql中，数据库为了高效，我们提交事务时，并不会立刻写入数据文件中（如果每个提交都写入数据文件中，那我们的数据库性能也太差了），中间通过了类似各种buffer，redo，undo等等的日志文件(这些后续的章节都会聊到)，因此这个持久性，这么看来就很有必要了。
